/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/adapterjs@0.15.4/tests/unit/RTCPeerConnection.event.spec.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var expect=chai.expect,assert=chai.assert,should=chai.should,testTimeout=35e3,gUMTimeout=25e3,testItemTimeout=4e3;describe("RTCPeerConnection | EventHandler",(function(){this.timeout(testTimeout);var e=null,t=null,n=null;before((function(t){this.timeout(testItemTimeout),AdapterJS.webRTCReady((function(){window.navigator.getUserMedia({audio:!0,video:!0},(function(n){e=n,t()}),(function(e){throw e}))}))})),beforeEach((function(e){this.slow(1e3),this.timeout(gUMTimeout+1e3),t=new RTCPeerConnection({iceServers:[]}),n=new RTCPeerConnection({iceServers:[]}),e()})),it("RTCPeerConnection.onnegotiationneeded :: emit < When > RTCPeerConnection.addStream(stream)",(function(n){this.timeout(testItemTimeout),t.onnegotiationneeded=function(){n()},t.addStream(e)})),it("RTCPeerConnection.onnegotiationneeded :: emit < When > RTCPeerConnection.removeStream(stream)",(function(n){this.timeout(testItemTimeout),t.onnegotiationneeded=function(){n()},t.removeStream(e)})),it("RTCPeerConnection.onicecandidate :: emit",(function(e){this.timeout(testItemTimeout);var i=0,o=0,a=!1,c=!1;checkdone=function(){a&&c&&(assert.notEqual(i,0),assert.notEqual(o,0),e())},t.onicecandidate=function(e){var t=e.candidate;null===t?(a=!0,checkdone()):(++i,n.addIceCandidate(t,(function(){}),(function(e){throw e})))},n.onicecandidate=function(e){var n=e.candidate;null===n?(c=!0,checkdone()):(++o,t.addIceCandidate(n,(function(){}),(function(e){throw e})))},connect(t,n)})),it("RTCPeerConnection.onsignalingstatechange :: emit",(function(e){this.timeout(testItemTimeout);var i=[],o=[],a=function(){isArrayEqual(i,["stable","have-local-offer","stable"])&&isArrayEqual(o,["stable","have-remote-offer","stable"])&&e()};t.onsignalingstatechange=function(){i.push(t.signalingState),a()},n.onsignalingstatechange=function(){o.push(n.signalingState),a()},i.push(t.signalingState),o.push(n.signalingState),connect(t,n)})),it("RTCPeerConnection.onaddstream :: emit",(function(i){this.timeout(testItemTimeout),n.onaddstream=function(t){var n=t.stream;expect(n.getAudioTracks()).to.have.length(e.getAudioTracks().length),expect(n.getVideoTracks()).to.have.length(e.getVideoTracks().length),i()},t.addStream(e),connect(t,n)})),it("RTCPeerConnection.onremovestream :: emit",(function(i){this.timeout(testItemTimeout),n.onaddstream=function(i){t.removeStream(e),connect(t,n)},n.onremovestream=function(){i()},t.addStream(e),connect(t,n)})),it("RTCPeerConnection.oniceconnectionstatechange :: emit",(function(e){this.timeout(testItemTimeout);var i=[],o=[],a=function(){isArrayEqual(i,["new","checking","completed","completed"])&&isArrayEqual(o,["new","checking","connected"])&&e()};t.oniceconnectionstatechange=function(){i.push(t.iceConnectionState),a()},n.oniceconnectionstatechange=function(){o.push(n.iceConnectionState),a()},i.push(t.iceConnectionState),o.push(n.iceConnectionState),connect(t,n)})),it("RTCPeerConnection.onicegatheringstatechange :: emit",(function(e){this.timeout(testItemTimeout);var i=[],o=[],a=function(){console.log(i),console.log(o),assert.deepEqual(i,["new","gathering","complete"]),assert.deepEqual(o,["new","gathering","complete"]),isArrayEqual(i,["new","gathering","complete"])&&isArrayEqual(o,["new","gathering","complete"])&&e()};t.onicegatheringstatechange=function(){i.push(t.iceGatheringState),a()},n.onicegatheringstatechange=function(){o.push(n.iceGatheringState),a()},i.push(t.iceGatheringState),o.push(n.iceGatheringState),connect(t,n)}))}));
//# sourceMappingURL=/sm/1ab2eee26ce3e1dc18be9f07763fce207ba619de722789bce8c58dc9897bffd2.map